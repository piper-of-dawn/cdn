filter_and_replace <- function(dt, column_name, filter_string, replace_list) {
    # Input validation
    if (!is.data.table(dt)) {
        stop("Input must be a data.table")
    }
    if (!column_name %in% names(dt)) {
        stop("Column name not found in data.table")
    }
    if (!all(names(replace_list) %in% names(dt))) {
        stop("Some columns in replace_list not found in data.table")
    }
    
    # Create a copy to avoid modifying the original data.table
    result_dt <- copy(dt)
    
    # Use .SD to update multiple columns at once
    result_dt[get(column_name) == filter_string, 
             (names(replace_list)) := replace_list]
    
    return(result_dt)
}