Let $x_i$ be the $i$â€Šth element of your flattened matrix (size $N=2048\times136$), and let $\alpha$ be the weighting constant (e.g.\ $0.1234567$). Then the sin-projection hash is

$$
h = \frac{1}{N}\sum_{i=0}^{N-1} x_i\,\sin(\alpha\,i).
$$

Equivalently, for a matrix $M$ with $R$ rows and $C$ columns ($N=RC$), flattening row-major gives $i = r\,C + c$, so

$$
h = \frac{1}{RC}
\sum_{r=0}^{R-1}\sum_{c=0}^{C-1}
M_{r,c}\,\sin\bigl(\alpha\,(r\,C + c)\bigr).
$$


import math

def sinproj_hash(data, alpha=0.1234567):
    """
    Compute a similarity-preserving hash for a flat buffer of doubles.
    Returns a single floating-point value.
    """
    N = len(data)
    if N == 0:
        return 0.0
    return sum(val * math.sin(i * alpha) for i, val in enumerate(data)) / N

# Test cases
def test_identical():
    data = [1.0, 2.0, 3.0, 4.0]
    h1 = sinproj_hash(data)
    h2 = sinproj_hash(data.copy())
    assert h1 == h2, "Identical data should yield identical hashes"
    print("Identical test passed:", h1, h2)

def test_similar():
    data1 = [1.0, 2.0, 3.0, 4.0]
    data2 = [1.0, 2.0, 3.0001, 4.0]  # small perturbation
    h1 = sinproj_hash(data1)
    h2 = sinproj_hash(data2)
    print("Similar test:")
    print("  Hash1:", h1)
    print("  Hash2:", h2)
    print("  Difference:", abs(h1 - h2))

def test_different():
    data1 = [1.0, 2.0, 3.0, 4.0]
    data2 = [4.0, 3.0, 2.0, 1.0]  # reversed order
    h1 = sinproj_hash(data1)
    h2 = sinproj_hash(data2)
    assert abs(h1 - h2) > 1e-6, "Different data should yield noticeably different hashes"
    print("Different test passed:", h1, h2)

if __name__ == "__main__":
    test_identical()
    test_similar()
    test_different()



#!/bin/bash

# Function to disable sleep settings
disable_sleep() {
    echo "Disabling sleep settings..."
    sudo systemctl mask sleep.target suspend.target hibernate.target hybrid-sleep.target
    sudo systemctl stop sleep.target suspend.target hibernate.target hybrid-sleep.target
}

# Function to re-enable sleep settings
reenable_sleep() {
    echo "Re-enabling sleep settings..."
    sudo systemctl unmask sleep.target suspend.target hibernate.target hybrid-sleep.target
    sudo systemctl start sleep.target suspend.target hibernate.target hybrid-sleep.target
}

# Trap to re-enable sleep settings when the script is terminated
trap reenable_sleep EXIT

# Disable sleep settings initially
disable_sleep

# Run 'ats' (Replace '/path/to/ats' with the actual path of your 'ats' binary)
echo "Starting ats..."
/path/to/ats &

# Wait for ats to finish (or loop if you want it to run continuously)
wait $!

# If 'ats' terminates, re-enable sleep settings
echo "ats has finished or was terminated, re-enabling sleep settings."
